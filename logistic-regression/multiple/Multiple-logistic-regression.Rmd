# import data
library(dplyr)
library(scatterplot3d)
library(ROCR)

#Load data
framingham <- read.csv(file.choose())
framingham

#Replace NA values in dataset
framingham[is.na(framingham)]=0

#Split train & test
set.seed(1234)
datasize = round(nrow(framingham)*.80) 
train <- sample_n(framingham, datasize)
train

data_id <- as.numeric(rownames(train)) 
test <- framingham[-data_id,]
test


#CreateModel
model <- glm(TenYearCHD~ male + age + cigsPerDay + prevalentStroke + sysBP + glucose, family = binomial(link = "logit"), data = train)
summary(model)

#GetResult
coef(model) %>% 
  exp() %>% 
  round(digits = 6)

#BuildPlot
##Plot base on age and sysBP
train %>% 
  mutate(fitted = fitted(model)) %>% 
  select(age, sysBP,fitted) %>% 
  scatterplot3d(color = "red")
  

prob<-predict(model,test,type="response")
table(prob>0.5)
