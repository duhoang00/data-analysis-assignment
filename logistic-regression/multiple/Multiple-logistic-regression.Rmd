# import data
library(dplyr)
library(scatterplot3d)
library(ROCR)

#Load data
df <- read.csv(file.choose())
df

#Replace NA values in dataset
df[is.na(df)]=0

#Transfer data
df['deposit'] = yes <- 1
df['deposit'] = no <- 0

#Split train & test
set.seed(100)
datasize = round(nrow(df)*.80) 
train <- sample_n(df, datasize)
train

data_id <- as.numeric(rownames(df)) 
test <- df[-data_id,]
test


#CreateModel
model <- glm(deposit~ ., family = binomial(link = "logit"), data = train)
summary(model)

#GetResult
coef(model) %>% 
  exp() %>% 
  round(digits = 6)

#BuildPlot
##Plot base on age and sysBP
train %>% 
  mutate(fitted = fitted(model)) %>% 
  select(balance, duration,fitted) %>% 
  scatterplot3d(color = "red")
  

prob<-predict(model,test,type="response")
table(prob>0.5)
